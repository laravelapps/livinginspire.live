!function(e){var t=!1;if("function"==typeof define&&define.amd&&(define("utils/js.storage",e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var n=window.Storages,i=window.Storages=e();i.noConflict=function(){return window.Storages=n,i}}}(function(){function e(){var e,t,n,i,o,r=this._type,a=arguments.length,s=window[r],c=arguments,u=c[0];if(a<1)throw new Error("Minimum 1 argument must be given");if(Array.isArray(u)){t={};for(i in u)if(u.hasOwnProperty(i)){e=u[i];try{t[e]=JSON.parse(s.getItem(e))}catch(n){t[e]=s.getItem(e)}}return t}if(1!=a){try{t=JSON.parse(s.getItem(u))}catch(e){throw new ReferenceError(u+" is not defined in this storage")}for(i=1;i<a-1;i++)if(void 0===(t=t[c[i]]))throw new ReferenceError([].slice.call(c,1,i+1).join(".")+" is not defined in this storage");if(Array.isArray(c[i])){n=t,t={};for(o in c[i])c[i].hasOwnProperty(o)&&(t[c[i][o]]=n[c[i][o]]);return t}return t[c[i]]}try{return JSON.parse(s.getItem(u))}catch(e){return s.getItem(u)}}function t(){var e,t,n,i,o=this._type,r=arguments.length,a=window[o],s=arguments,u=s[0],l=s[1],m=isNaN(l)?{}:[];if(r<1||!c(u)&&r<2)throw new Error("Minimum 2 arguments must be given or first parameter must be an object");if(c(u)){for(i in u)u.hasOwnProperty(i)&&(e=u[i],c(e)||this.alwaysUseJson?a.setItem(i,JSON.stringify(e)):a.setItem(i,e));return u}if(2==r)return"object"==typeof l||this.alwaysUseJson?a.setItem(u,JSON.stringify(l)):a.setItem(u,l),l;try{n=a.getItem(u),null!=n&&(m=JSON.parse(n))}catch(e){}for(n=m,i=1;i<r-2;i++)e=s[i],t=isNaN(s[i+1])?"object":"array",(!n[e]||"object"==t&&!c(n[e])||"array"==t&&!Array.isArray(n[e]))&&(n[e]="array"==t?[]:{}),n=n[e];return n[s[i]]=s[i+1],a.setItem(u,JSON.stringify(m)),m}function n(){var e,t,n,i,o=this._type,r=arguments.length,a=window[o],s=arguments,c=s[0];if(r<1)throw new Error("Minimum 1 argument must be given");if(Array.isArray(c)){for(n in c)c.hasOwnProperty(n)&&a.removeItem(c[n]);return!0}if(1==r)return a.removeItem(c),!0;try{e=t=JSON.parse(a.getItem(c))}catch(e){throw new ReferenceError(c+" is not defined in this storage")}for(n=1;n<r-1;n++)if(void 0===(t=t[s[n]]))throw new ReferenceError([].slice.call(s,1,n).join(".")+" is not defined in this storage");if(Array.isArray(s[n]))for(i in s[n])s[n].hasOwnProperty(i)&&delete t[s[n][i]];else delete t[s[n]];return a.setItem(c,JSON.stringify(e)),!0}function i(e){var t,i=a.call(this);for(t in i)i.hasOwnProperty(t)&&n.call(this,i[t]);if(e)for(t in y.namespaceStorages)y.namespaceStorages.hasOwnProperty(t)&&s(t)}function o(){var t,n=arguments.length,i=arguments,r=i[0];if(0==n)return 0==a.call(this).length;if(Array.isArray(r)){for(t=0;t<r.length;t++)if(!o.call(this,r[t]))return!1;return!0}try{var s=e.apply(this,arguments);Array.isArray(i[n-1])||(s={totest:s});for(t in s)if(s.hasOwnProperty(t)&&!(c(s[t])&&u(s[t])||Array.isArray(s[t])&&!s[t].length||"boolean"!=typeof s[t]&&!s[t]))return!1;return!0}catch(e){return!0}}function r(){var t,n=arguments.length,i=arguments,o=i[0];if(n<1)throw new Error("Minimum 1 argument must be given");if(Array.isArray(o)){for(t=0;t<o.length;t++)if(!r.call(this,o[t]))return!1;return!0}try{var a=e.apply(this,arguments);Array.isArray(i[n-1])||(a={totest:a});for(t in a)if(a.hasOwnProperty(t)&&(void 0===a[t]||null===a[t]))return!1;return!0}catch(e){return!1}}function a(){var t=this._type,n=arguments.length,i=window[t],o=[],r={};if((r=n>0?e.apply(this,arguments):i)&&r._cookie){var a=Cookies.get();for(var s in a)a.hasOwnProperty(s)&&""!=s&&o.push(s.replace(r._prefix,""))}else for(var c in r)r.hasOwnProperty(c)&&o.push(c);return o}function s(e){if(!e||"string"!=typeof e)throw new Error("First parameter must be a string");w?(window.localStorage.getItem(e)||window.localStorage.setItem(e,"{}"),window.sessionStorage.getItem(e)||window.sessionStorage.setItem(e,"{}")):(window.localCookieStorage.getItem(e)||window.localCookieStorage.setItem(e,"{}"),window.sessionCookieStorage.getItem(e)||window.sessionCookieStorage.setItem(e,"{}"));var t={localStorage:l({},y.localStorage,{_ns:e}),sessionStorage:l({},y.sessionStorage,{_ns:e})};return"undefined"!=typeof Cookies&&(window.cookieStorage.getItem(e)||window.cookieStorage.setItem(e,"{}"),t.cookieStorage=l({},y.cookieStorage,{_ns:e})),y.namespaceStorages[e]=t,t}function c(e){var t,n;return!(!e||"[object Object]"!==f.call(e))&&(!(t=p(e))||"function"==typeof(n=d.call(t,"constructor")&&t.constructor)&&h.call(n)===g)}function u(e){var t;for(t in e)return!1;return!0}function l(){for(var e=1,t=arguments[0];e<arguments.length;e++){var n=arguments[e];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}var m={},f=m.toString,d=m.hasOwnProperty,h=d.toString,g=h.call(Object),p=Object.getPrototypeOf,y={},w=function(e){try{return!!window[e]&&(window[e].setItem("jsapi","jsapi"),window[e].removeItem("jsapi"),!0)}catch(e){return!1}}("localStorage"),S={_type:"",_ns:"",_callMethod:function(e,t){t=Array.prototype.slice.call(t);var n=[],i=t[0];return this._ns&&n.push(this._ns),"string"==typeof i&&-1!==i.indexOf(".")&&(t.shift(),[].unshift.apply(t,i.split("."))),[].push.apply(n,t),e.apply(this,n)},alwaysUseJson:!1,get:function(){return this._callMethod(e,arguments)},set:function(){var e=arguments.length,n=arguments,i=n[0];if(e<1||!c(i)&&e<2)throw new Error("Minimum 2 arguments must be given or first parameter must be an object");if(c(i)&&this._ns){for(var o in i)i.hasOwnProperty(o)&&this._callMethod(t,[o,i[o]]);return i}var r=this._callMethod(t,n);return this._ns?r[i.split(".")[0]]:r},remove:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(n,arguments)},removeAll:function(e){return this._ns?(this._callMethod(t,[{}]),!0):this._callMethod(i,[e])},isEmpty:function(){return this._callMethod(o,arguments)},isSet:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(r,arguments)},keys:function(){return this._callMethod(a,arguments)}};if("undefined"!=typeof Cookies){window.name||(window.name=Math.floor(1e8*Math.random()));var v={_cookie:!0,_prefix:"",_expires:null,_path:null,_domain:null,setItem:function(e,t){Cookies.set(this._prefix+e,t,{expires:this._expires,path:this._path,domain:this._domain})},getItem:function(e){return Cookies.get(this._prefix+e)},removeItem:function(e){return Cookies.remove(this._prefix+e,{path:this._path})},clear:function(){var e=Cookies.get();for(var t in e)e.hasOwnProperty(t)&&""!=t&&(!this._prefix&&-1===t.indexOf("ls_")&&-1===t.indexOf("ss_")||this._prefix&&0===t.indexOf(this._prefix))&&Cookies.remove(t)},setExpires:function(e){return this._expires=e,this},setPath:function(e){return this._path=e,this},setDomain:function(e){return this._domain=e,this},setConf:function(e){return e.path&&(this._path=e.path),e.domain&&(this._domain=e.domain),e.expires&&(this._expires=e.expires),this},setDefaultConf:function(){this._path=this._domain=this._expires=null}};w||(window.localCookieStorage=l({},v,{_prefix:"ls_",_expires:3650}),window.sessionCookieStorage=l({},v,{_prefix:"ss_"+window.name+"_"})),window.cookieStorage=l({},v),y.cookieStorage=l({},S,{_type:"cookieStorage",setExpires:function(e){return window.cookieStorage.setExpires(e),this},setPath:function(e){return window.cookieStorage.setPath(e),this},setDomain:function(e){return window.cookieStorage.setDomain(e),this},setConf:function(e){return window.cookieStorage.setConf(e),this},setDefaultConf:function(){return window.cookieStorage.setDefaultConf(),this}})}return y.initNamespaceStorage=function(e){return s(e)},w?(y.localStorage=l({},S,{_type:"localStorage"}),y.sessionStorage=l({},S,{_type:"sessionStorage"})):(y.localStorage=l({},S,{_type:"localCookieStorage"}),y.sessionStorage=l({},S,{_type:"sessionCookieStorage"})),y.namespaceStorages={},y.removeAllStorages=function(e){y.localStorage.removeAll(e),y.sessionStorage.removeAll(e),y.cookieStorage&&y.cookieStorage.removeAll(e),e||(y.namespaceStorages={})},y.alwaysUseJsonInStorage=function(e){S.alwaysUseJson=e,y.localStorage.alwaysUseJson=e,y.sessionStorage.alwaysUseJson=e,y.cookieStorage&&(y.cookieStorage.alwaysUseJson=e)},y}),function(e){if("function"==typeof define&&define.amd)define("utils/js.cookie",e);else if("object"==typeof exports)module.exports=e();else{var t=window.Cookies,n=window.Cookies=e(window.jQuery);n.noConflict=function(){return window.Cookies=t,n}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(n){function i(t,o,r){var a;if(arguments.length>1){if(r=e({path:"/"},i.defaults,r),"number"==typeof r.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*r.expires),r.expires=s}try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}return o=encodeURIComponent(String(o)),o=o.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,r.expires&&"; expires="+r.expires.toUTCString(),r.path&&"; path="+r.path,r.domain&&"; domain="+r.domain,r.secure&&"; secure"].join("")}t||(a={});for(var c=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var m=c[l].split("="),f=m[0].replace(u,decodeURIComponent),d=m.slice(1).join("=");if('"'===d.charAt(0)&&(d=d.slice(1,-1)),d=n&&n(d,f)||d.replace(u,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(t===f){a=d;break}t||(a[f]=d)}return a}return i.get=i.set=i,i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(t,n){i(t,"",e(n,{expires:-1}))},i.withConverter=t,i}return t()}),define("components/community-ou-storage",["jquery","utils/js.storage"],function(e,t){return{init:function(){this.updateStorage(null)},updateStorage:function(t){var n=this,i=window.location.pathname;if(i.indexOf("/communities/")>=0){var o=e(".community-ou-number");if(o.length>0)n.setStorage(o.val()),t&&t();else{var r=i.indexOf("/communities/")+"/communities/".length,a=i.indexOf("/",r),s=i.substring(r,a),c="/data-api/personalization/getounumber/"+s;e.ajax({dataType:"json",method:"GET",url:c,success:function(e){if(e){var i=e;i&&(n.setStorage(i),t&&t())}},error:function(e,n){t&&t()}})}}else t&&t()},setStorage:function(e){var n=t.localStorage.get("recentounumbers").toString();if(n){n=n.toString(),n=n.split(",");var i=n[0];if(n.length>1&&(i=n[0]),e!=i){if(n.indexOf(e)>=0){var o=n.indexOf(e);-1!==o&&n.splice(o,1)}n.unshift(e),n.length>3&&(n=n.slice(0,3)),n=n.toString(),t.localStorage.set("recentounumbers",n)}}else t.localStorage.set("recentounumbers",e)}}}),define("components/get-location",["jquery","utils/js.storage","utils/js.cookie"],function(e,t,n){return{init:function(){},getLocation:function(i){var o=this,r=o.checkGeolocationExpirationTime();n.get("location")&&(o.setLocation(n.get("location")),n.remove("location"),o.setGeolocationTime());var a=t.localStorage.get("location");if(r&&a&&(t.localStorage.remove("location"),a=null),a)o.setGeolocationTime(),i&&i(a);else{e.ajax({dataType:"text",method:"GET",url:"/data-api/personalization/getlocation",success:function(e){if(e){var t=e;t?(o.declareGeolocationEvent("located",t),o.setLocation(t),i&&i(t)):(o.declareGeolocationEvent("unfound"),i&&i(null))}else o.declareGeolocationEvent("unfound"),i&&i(null)},error:function(){o.declareGeolocationEvent("unfound"),i&&i(null)}})}},setLocation:function(e){var n=this;t.localStorage.set("location",e),n.setGeolocationTime()},setGeolocationTime:function(){t.localStorage.set("geolocationTime",Date.now())},checkGeolocationExpirationTime:function(){var e=t.localStorage.get("geolocationTime");if(e){var n=new Date(e),i=new Date(new Date(n).setMinutes(n.getMinutes()+30));return new Date(Date.now())>i}return!1},declareGeolocationEvent:function(e,t){var n=window.dataLayer=window.dataLayer||[];t?n.push({event:"location-status",geolocation:e,location:t}):n.push({event:"location-status",geolocation:e})},declareManualGeolocationEvent:function(e){var t=window.dataLayer=window.dataLayer||[];e&&t.push({event:"location-status",geolocation:"manually-entered",manualLocation:e})}}}),define("components/last-visited-community",["jquery","utils/js.storage"],function(e,t){function n(t){if(t){var n="/data-api/personalization/getlastvisitedcommunity/"+t;e.ajax({dataType:"json",method:"GET",url:n,success:function(e){if(e){var t=e;if(t){settings.$lastVisitedCommunityNameAndLink.html('<a href="'+t.communityurl+'">'+t.communityname+"</a>");var n=!1;"mobile"==MQ.getContext()&&(n=!0),n||(settings.$findAnotherSunrise.show(),settings.$findASunrise.hide()),settings.$findASunriseSearch.hide(),settings.$findCommunityDefaultImage.hide(),settings.$findCommunityImageLink.attr("href",t.communityurl),settings.$findCommunityImageLink.append('<img src="'+t.communityimage+'" alt="'+t.communityimagealt+'" />'),settings.$findCommunityImageLink.show(),t.communitysalesphonenumber&&(settings.$communitySearchHeaderContact.attr("href","tel:"+t.communitysalesphonenumber),settings.$communitySearchHeaderPhone.html(t.communitysalesphonenumber))}}},error:function(e,t){i()}})}}function i(){settings.$findAnotherSunrise.hide(),settings.$findASunrise.show(),settings.$findASunriseSearch.show()}function o(){var e=t.localStorage.get("recentounumbers");if(e){e=e.toString(),e=e.split(",");return e[0]}}return settings={},{init:function(){settings={$lastVisitedCommunityNameAndLink:e("#last-visited-community-name"),$findAnotherSunrise:e("#find-another-sunrise"),$findASunrise:e("#find-a-sunrise"),$findASunriseSearch:e("#find-a-sunrise-search"),$findCommunityImageLink:e("#find-community-image-link"),$findCommunityDefaultImage:e("#find-community-default-image"),$communitySearchHeaderContact:e(".community-search-header__contact"),$communitySearchHeaderPhone:e(".community-search-header__phone")},lastVisitedCommunity=o(),lastVisitedCommunity&&n(lastVisitedCommunity)}}}),define("components/lead-gen-data-layer",["jquery","utils/js.cookie"],function(e,t){return{init:function(){var n=t.get("leadresponse");if(n){var i=e.parseJSON(n);if(i){var o=i.leadid,r=i.commlead;if(o&&r){(window.dataLayer=window.dataLayer||[]).push({event:"successful-form-submission",leadid:o.toString(),community:r.toString()})}}t.remove("leadresponse")}}}}),define("components/header-personalization",["jquery","utils/js.storage","utils/js.cookie","components/community-ou-storage","components/get-location","components/last-visited-community","components/lead-gen-data-layer"],function(e,t,n,i,o,r,a){function s(){o.getLocation(c)}function c(e){var n=t.localStorage.get("recentounumbers");n?(d.$communitySearchHeader.removeClass("hide-recently-viewed"),l(n.toString()),r.init()):(d.$communitySearchHeader.addClass("hide-recently-viewed"),f(e)),e&&(u(e),m(e))}function u(e){d.$headerSearchBox.val(e),d.$headerSearchLabel.text(e)}function l(t){var n=encodeURI("/data-api/personalization/getrecentlyvisitedcommunities/"+t);e.ajax({dataType:"html",method:"GET",url:n,success:function(e){e&&d.$recentlyVisited.html(e)},error:function(e,t){d.$recentlyVisited.hide()}})}function m(t){var n=encodeURI("/data-api/personalization/getviewcommunitiesnearsearchurl/"+t);e.ajax({dataType:"json",method:"GET",url:n,success:function(e){e&&(e.communitiesAreNearby?(d.$viewCommunitiesNearZip.text(t+" "),d.$viewCommunitiesNearLink.attr("href",e.url),d.$viewCommunitiesNearLink.show()):d.$viewCommunitiesNearLink.hide())},error:function(e,t){d.$viewCommunitiesNearLink.hide()}})}function f(t){var n=this;t&&(url="/data-api/personalization/getnearbycommunitiescount/"+t,e.ajax({dataType:"text",method:"GET",url:url,success:function(e){if(e){var t=e;if(t&&t>0){var n=!1;"desktop"!==MQ.getContext()&&(n=!0),n||(d.$lastVisitedCommunityNameAndLink.html(t+" Nearby Communities"),d.$lastVisitedCommunityNameAndLink.show(),d.$findAnotherSunrise.html("Find a Sunrise "),d.$findAnotherSunrise.show(),d.$findASunrise.hide(),d.$findASunriseSearch.hide())}}},error:function(e,t){n.setDefaultExperience()}}))}var d={};return{init:function(){d={$communitySearchHeader:e("#communitySearchHeader"),$findAnotherSunrise:e("#find-another-sunrise"),$findASunrise:e("#find-a-sunrise"),$findASunriseSearch:e("#find-a-sunrise-search"),$headerSearchLabel:e(".community-search-header__search-zip"),$headerSearchBox:e(".header-community-search-text-box"),$lastVisitedCommunityNameAndLink:e("#last-visited-community-name"),$recentlyVisited:e("#recentlyVisited"),$viewCommunitiesNearLink:e("#viewCommunitiesNearLink"),$viewCommunitiesNearZip:e("#viewCommunitiesNearZip")},i.updateStorage(s),a.init()}}});